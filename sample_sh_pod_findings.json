{
    "version": "0",
    "id": "225b06f5-d216-d572-52e7-fe1ecfcd4e0e",
    "detail-type": "Security Hub Findings - Custom Action",
    "source": "aws.securityhub",
    "account": "<sechub-accountId>",
    "time": "2024-12-04T23:52:18Z",
    "region": "<region-name>",
    "resources": [
      "arn:aws:securityhub:<region-name>:<sechub-accountId>:action/custom/ForensicTriageAction"
    ],
    "detail": {
      "actionName": "Forensic Triage",
      "actionDescription": "Trigger Forensic Triage Action",
      "findings": [
        {
          "ProductArn": "arn:aws:securityhub:<region-name>::product/aws/guardduty",
          "Types": [
            "TTPs/Execution/Execution:Kubernetes-ExecInKubeSystemPod"
          ],
          "SourceUrl": "https://<region-name>.console.aws.amazon.com/guardduty/home?region=<region-name>#/findings?macros=current&fId=c7f427fd1eb14e36942c3083c5fe7861",
          "Description": "A command was executed inside a pod in the kube-system namespace on EKS Cluster GeneratedFindingEKSClusterName. If this behavior is not expected, it may indicate that your credentials are compromised.",
          "ProductName": "GuardDuty",
          "FirstObservedAt": "2024-10-03T14:40:08.000Z",
          "CreatedAt": "2024-10-03T14:40:08.389Z",
          "LastObservedAt": "2024-12-04T23:48:32.000Z",
          "CompanyName": "Amazon",
          "FindingProviderFields": {
            "Types": [
              "TTPs/Execution/Execution:Kubernetes-ExecInKubeSystemPod"
            ],
            "Severity": {
              "Normalized": 50,
              "Label": "MEDIUM",
              "Product": 5
            }
          },
          "ProductFields": {
            "aws/guardduty/service/archived": "false",
            "aws/guardduty/service/additionalInfo/value": "{\"sample\":true}",
            "aws/guardduty/service/action/kubernetesApiCallAction/verb": "create",
            "aws/guardduty/service/action/kubernetesApiCallAction/remoteIpDetails/country/countryName": "GeneratedFindingCountryName",
            "aws/guardduty/service/action/kubernetesApiCallAction/sourceIPs.0_": "10.0.0.23",
            "aws/guardduty/service/action/kubernetesApiCallAction/sourceIPs.2_": "10.0.0.25",
            "aws/guardduty/service/serviceName": "guardduty",
            "aws/guardduty/service/evidence": "",
            "aws/guardduty/service/detectorId": "58c54ab46d0b667fe47a2d82745538a3",
            "aws/guardduty/service/action/kubernetesApiCallAction/requestUri": "GeneratedFindingRequestURI",
            "aws/guardduty/service/action/kubernetesApiCallAction/remoteIpDetails/city/cityName": "GeneratedFindingCityName",
            "aws/guardduty/service/eventFirstSeen": "2024-10-03T14:40:08.000Z",
            "aws/guardduty/service/action/kubernetesApiCallAction/remoteIpDetails/organization/isp": "GeneratedFindingISP",
            "aws/guardduty/service/eventLastSeen": "2024-12-04T23:48:32.000Z",
            "aws/guardduty/service/action/actionType": "KUBERNETES_API_CALL",
            "aws/guardduty/service/action/kubernetesApiCallAction/userAgent": "",
            "aws/guardduty/service/action/kubernetesApiCallAction/remoteIpDetails/organization/asn": "0",
            "aws/guardduty/service/action/kubernetesApiCallAction/remoteIpDetails/ipAddressV4": "198.51.100.0",
            "aws/guardduty/service/action/kubernetesApiCallAction/remoteIpDetails/geoLocation/lat": "0",
            "aws/guardduty/service/action/kubernetesApiCallAction/remoteIpDetails/ipAddressV6": "1234:5678:90ab:cdef:1234:5678:90ab:cde0",
            "aws/guardduty/service/resourceRole": "TARGET",
            "aws/guardduty/service/action/kubernetesApiCallAction/sourceIPs.3_": "10.0.0.26",
            "aws/guardduty/service/action/kubernetesApiCallAction/statusCode": "101",
            "aws/guardduty/service/action/kubernetesApiCallAction/sourceIPs.1_": "10.0.0.24",
            "aws/guardduty/service/count": "2",
            "aws/guardduty/service/additionalInfo/sample": "true",
            "aws/guardduty/service/additionalInfo/type": "default",
            "aws/guardduty/service/action/kubernetesApiCallAction/remoteIpDetails/geoLocation/lon": "0",
            "aws/guardduty/service/action/kubernetesApiCallAction/remoteIpDetails/organization/org": "GeneratedFindingORG",
            "aws/guardduty/service/action/kubernetesApiCallAction/remoteIpDetails/organization/asnOrg": "GeneratedFindingASNOrg",
            "aws/securityhub/FindingId": "arn:aws:securityhub:<region-name>::product/aws/guardduty/arn:aws:guardduty:<region-name>:<app-accountId>:detector/58c54ab46d0b667fe47a2d82745538a3/finding/c7f427fd1eb14e36942c3083c5fe7861",
            "aws/securityhub/ProductName": "GuardDuty",
            "aws/securityhub/CompanyName": "Amazon"
          },
          "SchemaVersion": "2018-10-08",
          "GeneratorId": "arn:aws:guardduty:<region-name>:<app-accountId>:detector/58c54ab46d0b667fe47a2d82745538a3",
          "Sample": true,
          "RecordState": "ACTIVE",
          "Title": "A command was executed inside a pod in the kube-system namespace.",
          "Workflow": {
            "Status": "NEW"
          },
          "Severity": {
            "Normalized": 50,
            "Label": "MEDIUM",
            "Product": 5
          },
          "UpdatedAt": "2024-12-04T23:48:32.651Z",
          "WorkflowState": "NEW",
          "AwsAccountName": "container-ir-automation",
          "AwsAccountId": "<app-accountId>",
          "Region": "<region-name>",
          "Id": "arn:aws:guardduty:<region-name>:<app-accountId>:detector/58c54ab46d0b667fe47a2d82745538a3/finding/c7f427fd1eb14e36942c3083c5fe7861",
          "Resources": [
            {
              "Partition": "aws",
              "Type": "AwsEksCluster",
              "Details": {
                "Other": {
                  "kubernetesDetails/kubernetesUserDetails/groups.0_": "system:masters",
                  "kubernetesDetails/kubernetesUserDetails/username": "kubernetes-admin",
                  "kubernetesDetails/kubernetesUserDetails/uid": "aws-iam-authenticator:<app-accountId>:AROASJZ6NAUHFFIFPO57C",
                  "kubernetesDetails/kubernetesWorkloadDetails/name": "catalog-9748665d5-sbtfx",
                  "kubernetesDetails/kubernetesWorkloadDetails/namespace": "default",
                  "kubernetesDetails/kubernetesUserDetails/groups.1_": "system:authenticated",
                  "kubernetesDetails/kubernetesUserDetails/sessionName.1_": "colinms-Isengard",
                  "kubernetesDetails/kubernetesWorkloadDetails/type": "pods",
                  "kubernetesDetails/kubernetesUserDetails/sessionName.0_": "colinms-Isengard"
                },
                "AwsEksCluster": {
                  "Arn": "arn:aws:eks:<region-name>:<app-accountId>:cluster/eks-workshop",
                  "ClusterStatus": "ACTIVE",
                  "Name": "eks-workshop"
                }
              },
              "Region": "<region-name>",
              "Id": "arn:aws:eks:<region-name>:<app-accountId>:cluster/eks-workshop",
              "Tags": {
                "GeneratedFindingEKSClusterTag1": "GeneratedFindingEKSClusterTagValue1",
                "GeneratedFindingEKSClusterTag2": "GeneratedFindingEKSClusterTagValue2",
                "GeneratedFindingEKSClusterTag3": "GeneratedFindingEKSClusterTagValue3",
                "GeneratedFindingEKSClusterTag4": "GeneratedFindingEKSClusterTagValue4"
              }
            }
          ],
          "ProcessedAt": "2024-12-04T23:50:04.547Z"
        }
      ]
    }
  }